<!DOCTYPE html>
<html lang="es">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Primary Meta Tags -->
    <title>Pasha - Personal Assistant</title>
    <meta name="title" content="Alfred" />
    <meta name="description" content="Pre Screening Application for Social Security Disability Insurance (SSDI) or Supplemental Security Income (SSI) benefits." />
    <meta name="robots" content="index, follow">
    <meta name="keywords" content="National Disability Alliance, NDA, SSDI, SSI, NDA Assistant">

    <link rel="icon" type="image/png" href="assets/img/favicon/favicon.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css?v=7857324">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" type="text/css" media="all">
    <link rel="stylesheet" href="assets/css/pasha_beta.css">
    <link rel="stylesheet" href="assets/css/pasha_new.css">
    <link href="https://fonts.googleapis.com/css2?family=Amaranth:ital,wght@0,400;0,700;1,400;1,700&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">

    <!-- Import Map - Must come before any module scripts -->
    <script type="importmap">
      {
        "imports": {
          "@capacitor/core": "./assets/js/capacitor/core.js",
          "@capacitor/app": "./assets/js/capacitor/app.js",
          "@capacitor-community/speech-recognition": "./assets/js/capacitor/speech-recognition.js",
          "@capacitor-community/text-to-speech": "./assets/js/capacitor/customTextToSpeech.js",
          "@llama-node/llama-cpp": "./assets/js/llm/llama-cpp.js",
          "@capacitor/filesystem": "./assets/js/capacitor/filesystem.js",
          "./deviceSpeech.js": "./assets/js/deviceSpeech.js",
          "./deviceLLM.js": "./assets/js/deviceLLM.js",
          "./deviceController.js": "./assets/js/deviceController.js",
          "./agent_controller.js": "./assets/js/agent_controller.js", 
          "./system_prompt.js": "./assets/js/system_prompt.js",
          "./llm/llama.min.js": "./assets/js/llm/llama.min.js",
          "./llm/llama.wasm": "./assets/js/llm/llama.wasm"
        }
      }
    </script>
</head>
<body>

<div class="bot_load">
    <div class="pre_wrapper_clear">
      <div class="nda_bar"></div>
    <h1 class="splash_intro">Pasha</h1>
    <h1 class="splash_intro_text">First you need to enable your microphone</h1>
    <button id="startChatButton" class="btn btn-welcome mt-4 mx-auto">ENABLE MICROPHONE</button>

  </div>
</div>

<section class="agent-section container-fluid">
  <div class="agent_left hero_bg1">
    <div class="horizon_bot">
      <div class="msger horizon_hero">
        <header class="msger-header-agent">
          <div class="msger-header-content">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <style>.robot-icon{fill:#ffffff}</style>
              <path class="robot-icon" d="M12 2C13.1 2 14 2.9 14 4L14 6C14 7.11 13.11 8 12 8C10.9 8 10 7.11 10 6L10 4C10 2.9 10.9 2 12 2M17 8C18.1 8 19 8.9 19 10L19 16C19 17.1 18.1 18 17 18L7 18C5.9 18 5 17.1 5 16L5 10C5 8.9 5.9 8 7 8L17 8M7 10C6.45 10 6 10.45 6 11C6 11.55 6.45 12 7 12C7.55 12 8 11.55 8 11C8 10.45 7.55 10 7 10M17 10C16.45 10 16 10.45 16 11C16 11.55 16.45 12 17 12C17.55 12 18 11.55 18 11C18 10.45 17.55 10 17 10M12 14C10.9 14 10 14.9 10 16L14 16C14 14.9 13.1 14 12 14Z"/>
            </svg>
            <div class="msger-header-title">
              <span class="pashaLogoText">Pasha</span>
            </div>
            <div id="loader" class="msger-header-options progress"></div>
            <audio id="audioPlayer" controls style="display:none;">
              Audio Player
            </audio>
          </div>
        </header>
        <div class="clear_chat highest_index">
          <button id="clearChat" class="circle-btn terminal-medium">CLEAR</button>
        </div>
        <main class="msger-chat-welcome" id="chat-messages">

        </main>
      </div>
    </div>
  </div>
  <div class="agent_right dotbg">
    <div class="pasha_canvas">
      <!-- Display certain items in this div for example: Date and Time, pashaCalendar, fullReport Accordion -->
    </div>
    <div class="agent_screen" style="display:none;">
      <!-- Voice Action Readout -->
      <div class="agent_controll">
          <div class="voice_status text-center">
              <span id="voice-action" class="voiceSpan">Ready</span>
          </div>
      </div>

      <div class="llm_Readout">
          <div class="llm_readout_title terminal-medium light">Language Model: Gemini</div>
      </div>

      <div class="chronicle_mode">
        <!-- Chronicle mode interface -->
      </div>

      <div class="agent_s3">
        <!-- Large Language Model Selection -->
         <div class="llm-card gemini"></div>
         <div class="llm-card llama llm-card-active"></div>
         <div class="llm-card grok"></div>
         <div class="llm-card claude"></div>
         <div class="llm-card openAI"></div>
      </div>
    </div>
    <div class="pasha-nav">
      <div class="nav-wrap">
        <div class="wrap-top">
          <button class="push-talk-btn terminal-medium">PUSH TO TALK</button>
          <button class="pause-btn terminal-medium">PAUSE</button>
          <button class="new-question-btn terminal-medium" style="display:none;">NEW QUESTION</button>
        </div>
        <div id="main_buttons" class="wrap-bottom">
          <div class="button-container">
            <button id="askAnythingBtn" class="circle-btn terminal-medium">ASK MODES</button>
            <button id="meetingModeBtn" class="circle-btn terminal-medium">MEETING MODE</button>
            <button id="chronicleModeBtn" class="circle-btn terminal-medium">CHRONICLE</button>
            <button id="schedulerBtn" class="circle-btn terminal-medium">SCHEDULER</button>
            <button id="messengerBtn" class="circle-btn terminal-medium">MESSENGER</button>
            <button id="newsBtn" class="circle-btn terminal-medium">NEWS</button>
            <button id="settingsModeBtn" class="circle-btn terminal-medium">SETTINGS</button>
            <button id="historyModeBtn" class="circle-btn terminal-medium">HISTORY</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
    window._env_ = {
        apiKey: "10101101010111010100101",
        authDomain: "example.com",
        databaseURL: "example.com",
        projectId: "this_project",
        storageBucket: "this_bucket",
        messagingSenderId: "10101101010111010100101",
        appId: "10101101010111010100101",
        measurementId: "G-10101101010111010100101"
    }
</script>

<!-- Third Party Dependencies -->
<script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
<script src="assets/js/popper.min.js"></script>  
<script src="assets/js/bootstrap.min.js"></script>
<script src="https://unpkg.com/masonry-layout@4.2.2/dist/masonry.pkgd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js"></script>
<script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<!-- Firebase Dependencies -->
<script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-functions.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-storage.js"></script>

<!-- Application Scripts -->
<script src="assets/js/bundle.js"></script>
<script src="assets/js/animations.js"></script>
<script src="assets/js/language.js"></script>
<script src="assets/js/interaction.js"></script>
<script src="assets/js/pashaHelper.js"></script>
<script src="assets/js/pashaSecondary.js"></script>
<script type="module" src="assets/js/meetingController.js"></script>

<!-- Initialize controllers -->
<script type="module">
    import { DeviceController } from './assets/js/deviceController.js';
    import { MeetingController } from './assets/js/meetingController.js';
    
    document.addEventListener('DOMContentLoaded', () => {
        const botLoad = document.querySelector('.bot_load');
        const startChatButton = document.getElementById('startChatButton');
        const clearChatButton = document.getElementById('clearChat');

        // Add clear chat functionality
        clearChatButton?.addEventListener('click', () => {
            const chatMessages = document.getElementById('chat-messages');
            if (chatMessages) {
                while (chatMessages.firstChild) {
                    chatMessages.removeChild(chatMessages.firstChild);
                }
                // Add initial message back
                const initialMessage = document.createElement('div');
                initialMessage.classList.add('msg', 'left-msg');
                initialMessage.innerHTML = `
                    <div class="msg-img" style="background-image: url('assets/img/ux_icons/bot_icon.png')"></div>
                    <div class="msg-bubble">
                        <div class="msg-info">
                            <div class="msg-info-name">Pasha</div>
                        </div>
                        <div class="msg-text">
                            Pasha is ready. Push and hold the button to talk!
                        </div>
                    </div>
                `;
                chatMessages.appendChild(initialMessage);
            }
        });

        // Check if microphone was previously enabled
        if (localStorage.getItem('microphoneEnabled') === 'true') {
            botLoad.style.display = 'none';
            initializeControllers();
        } else {
            startChatButton.addEventListener('click', async () => {
                try {
                    await navigator.mediaDevices.getUserMedia({ audio: true });
                    localStorage.setItem('microphoneEnabled', 'true');
                    botLoad.style.display = 'none';
                    initializeControllers();
                } catch (error) {
                    console.error('Error accessing microphone:', error);
                    alert('Microphone access is required for this application.');
                }
            });
        }

        function initializeControllers() {
            const db = firebase.firestore();
            
            // Initialize controllers
            const meetingController = new MeetingController(db);
            const deviceController = new DeviceController();
            
            meetingController.init();
            deviceController.init();
        }
    });
</script>
</body>
</html></html>